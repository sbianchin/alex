//Some Global Variables
char TWParams_path[] = "../TargetTimeWalk/Results/";
bool Tvert = false;
// track parameters
double TrkSlope, TrkB;
double rTOF1 = 44.5, Xsq;
double xTOF1[2], yTOF1[2];
double Ytest[256], DYtest[256];
// Cluster search stuff
int NLid[nBars], NKid[nBars], HGPedHit[nBars], LGPedHit[nBars], HGpedOffset, LGpedOffset;
int XKmean, YKmean;
int iE[4];
// Save stuff
double XSLhit[nBars],YSLhit[nBars],ESLhit[nBars],TSLhit[nBars];
double XSKhit[nBars],YSKhit[nBars],ESKhit[nBars],TSKhit[nBars];
double SLid[nBars],SKid[nBars];
double NLXhit[nBars],NLYhit[nBars],NLEhit[nBars],NLThit[nBars];
int KIDed[nBars];
int NotLeptonCount = 0;
// TOF stuff
Int_t RealGap;
Int_t RealTOF1;
double TOF1X[nGaps], TOF1Y[nGaps];
double xmean, ymean, ytemp, xvarian, yvarian, xSD, ySD, xwidth, ywidth;
// Possible width of vertical track
double vertlim = 6.2; // = 2.0 bars // 4.55; = 1.5 bars;  //9.3; // 3 bars 3.1; //= 1 bar; //0.775;
double VertSlope;
Int_t FirstEvent = 1;
Int_t tdclow = 720; //650; //750; //700;
Int_t tdchi = 950; //1050;
Int_t tdchim3, tdchim2, tdchim1;
Int_t tdchip1, tdchip2, tdchip3, tdchip4;
Int_t NewTDCpar[nBars];
Int_t NewTDCrms[nBars];
Int_t tdcKlow = 720;
Int_t tdcKhi = 880;
Int_t adcKHGmin = 3000;
Int_t adcKLGmin = 1100;
Int_t adcLHGmin = 850;
Int_t EKLcut = 2500;
Int_t Emax = -1;
Int_t Tmax = -1;
Int_t Emin = 10000;
Int_t Tmin = 10000;
Int_t iMaxE = -1;
Int_t iKmaxE = -1;
Int_t iMinE = 10000;
Int_t iMaxT = -1;
Int_t iMinT = 10000;
Int_t Tdiffmax = 0;
//Double_t tw_par[nBars][npar];
//Double_t tw_par_err[nBars][npar];
Int_t TDC_LE_Correct[nBars];
//Double_t TOF1Angles[12] = {30.0,60.0,90.0,120.0,150.0,180.0,210.0,240.0,270.0,300.0,330.0,0.0};
Double_t TOF1Angles[12] = {60.0,30.0,0.0,330.0,300.0,270.0,240.0,210.0,180.0,150.0,120.0,90.0};
Double_t RadionAngle = 180.0/3.14159265;
Int_t TARGET_neighbours[256][8] =
{
    -1,-1,-1,1,9,8,7,-1, -1,-1,-1,2,10,9,8,0, -1,-1,-1,3,11,10,9,1, -1,-1,-1,4,12,11,10,2, -1,-1,-1,5,13,12,11,3, // 5
    -1,-1,-1,-1,14,13,12,4, -1,-1,-1,7,18,17,16,-1, -1,-1,0,8,19,18,17,6, -1,0,1,9,20,19,18,7, 0,1,2,10,21,20,19,8,// 10
    1,2,3,11,22,21,20,9, 2,3,4,12,23,22,21,10, 3,4,5,13,24,23,22,11, 4,5,-1,14,25,24,23,12, 5,-1,-1,15,26,25,24,13, //15
    -1,-1,-1,-1,27,26,25,14, -1,-1,6,17,30,29,28,-1, -1,6,7,18,31,30,29,16, 6,7,8,19,32,31,30,15, 7,8,9,20,33,32,31,16, //20
    8,9,10,21,34,33,32,19, 9,10,11,22,35,34,33,20, 10,11,12,23,36,35,34,21, 11,12,13,24,37,36,35,22, 12,13,14,25,38,37,36,23, // 25
    13,14,15,26,39,38,37,24, 14,15,-1,27,40,39,38,25, 15,-1,-1,-1,41,40,39,26, -1,-1,16,29,44,43,42,-1, -1,16,17,30,45,44,43,28, //30
    16,17,18,31,46,45,44,29, 17,18,19,32,47,46,45,30, 18,19,20,33,48,47,46,31, 19,20,21,34,49,48,47,32, 20,21,22,35,50,49,48,33, // 35
    21,22,23,36,51,50,49,34, 22,23,24,37,52,51,50,35, 23,24,25,38,53,52,51,36, 24,25,26,39,54,53,52,37, 25,26,27,40,55,54,53,38, // 40
    26,27,-1,41,56,55,54,39, 27,-1,-1,-1,57,56,55,40, -1,-1,28,43,59,58,-1,-1, -1,28,29,44,60,59,58,42, 28,29,30,45,61,60,59,43, //45
    29,30,31,46,62,61,60,44, 30,31,32,47,63,62,61,45, 31,32,33,48,64,63,62,46, 32,33,34,49,65,64,63,47, 33,34,35,50,66,65,64,48, //50
    34,35,36,51,67,66,65,49, 35,36,37,52,68,67,66,50, 36,37,38,53,69,68,67,51, 37,38,39,54,70,69,68,52, 38,39,40,55,71,70,69,53, //55
    39,40,41,56,72,71,70,54, 40,41,-1,57,73,72,71,55, 41,-1,-1,-1,-1,73,72,56, -1,42,43,59,76,75,74,-1, 42,43,44,60,77,76,75,58, //60
    43,44,45,61,78,77,76,59, 44,45,46,62,79,78,77,60, 45,46,47,63,80,79,78,61, 46,47,48,64,81,80,79,62, 47,48,49,65,82,81,80,63,//65
    48,49,50,66,83,82,81,64, 49,50,51,67,84,83,82,65, 50,51,52,68,85,84,83,66, 51,52,53,69,86,85,84,67, 52,53,54,70,87,86,85,68,//70
    53,54,55,71,88,87,86,69, 54,55,56,72,89,88,87,70, 55,56,57,73,90,89,88,71, 56,57,-1,-1,91,90,89,72, -1,-1,58,75,93,92,-1,-1,//75
    -1,58,59,76,94,93,92,74, 58,59,60,77,95,94,93,75, 59,60,61,78,96,95,94,76, 60,61,62,79,97,96,95,77, 61,62,63,80,98,97,96,78,//80
    62,63,64,81,99,98,97,79, 63,64,65,82,100,99,98,80, 64,65,66,83,101,100,99,81, 65,66,67,84,102,101,100,82, 66,67,68,85,103,102,101,83, //85
    67,68,69,86,104,103,102,84, 68,69,70,87,105,104,103,85, 69,70,71,88,106,105,104,86, 70,71,72,89,107,106,105,87, 71,72,73,90,108,107,106,88, //90
    72,73,-1,91,109,108,107,89, 73,-1,-1,-1,-1,109,108,90, -1,74,75,93,111,110,-1,-1, 74,75,76,94,112,111,110,92, 75,76,77,95,113,112,11,93, //95
    76,77,78,96,114,113,112,94, 77,78,79,97,115,114,113,95, 78,79,80,98,116,115,114,96, 79,80,81,99,117,116,115,97, 80,81,82,100,118,117,116,98, //100
    81,82,83,101,119,118,117,99, 82,83,84,102,120,119,118,100, 83,84,85,103,121,120,119,101, 84,85,86,104,122,121,120,102, 85,86,87,105,123,122,121,103, //105
    86,87,88,106,124,123,122,104, 87,88,89,107,125,124,123,105, 88,89,90,108,126,125,124,106, 89,90,91,109,127,126,125,107, 90,91,-1,-1,-1,127,126,108, //110
    -1,92,93,111,129,128,-1,-1, 92,93,94,112,130,129,128,110, 93,94,95,113,131,130,129,111, 94,95,96,114,132,131,130,112, 95,96,97,115,133,132,131,113, //115
    96,97,98,116,134,133,132,114, 97,98,99,117,135,134,133,115, 98,99,100,118,136,135,134,116, 99,100,101,119,137,136,135,117, 100,101,102,120,138,137,136,118, //120
    101,102,103,121,139,138,137,119, 102,103,104,122,140,139,138,120, 103,104,105,123,141,140,139,121, 104,105,106,124,142,141,140,122, 105,106,107,125,143,142,141,123, //125
    106,107,108,126,144,143,142,124, 107,108,109,127,145,144,143,125, 108,109,-1,-1,-1,145,144,126, -1,110,111,129,147,146,-1,-1, 110,111,112,130,148,147,146,128, //130
    111,112,113,131,149,148,147,129, 112,113,114,132,150,149,148,130, 113,114,115,133,151,150,149,131, 114,115,116,134,152,151,150,132, 115,116,117,135,153,152,151,133, //135
    116,117,118,136,154,153,152,134, 117,118,119,137,155,154,153,135, 118,119,120,138,156,155,154,136, 119,120,121,139,157,156,155,137, 120,121,122,140,158,157,156,138, //140
    121,122,123,141,159,158,157,139, 122,123,124,142,160,159,158,140, 123,124,125,143,161,160,159,141, 124,125,126,144,162,161,160,142, 125,126,127,145,163,162,161,143, //145
    126,127,-1,-1,-1,163,162,144,  -1,128,129,147,165,164,-1,-1, 128,129,130,148,166,165,164,146, 129,130,131,149,167,166,165,147, 130,131,132,150,168,167,166,148, //150
    131,132,133,151,169,168,167,149, 132,133,134,152,170,169,168,150, 133,134,135,153,171,170,169,151, 134,135,136,154,172,171,170,152, 135,136,137,155,173,172,171,153, //155
    136,137,138,156,174,173,172,154, 137,138,139,157,175,174,173,155, 138,139,140,158,176,175,174,156, 139,140,141,159,177,176,175,157, 140,141,142,160,178,177,176,158, //160
    141,142,143,161,179,178,177,159, 142,143,144,162,180,179,178,160, 143,144,145,163,181,180,179,161, 144,145,-1,-1,-1,181,180,162, -1,146,147,165,182,-1,-1,-1, //165
    146,147,148,166,183,182,-1,164, 147,148,149,167,184,183,182,165, 148,149,150,168,185,184,183,166, 149,150,151,169,186,185,184,167, 150,151,152,170,187,186,185,168, //170
    151,152,153,171,188,187,186,169, 152,153,154,172,189,188,187,170, 153,154,155,173,190,189,188,171, 154,155,156,174,191,190,189,172, 155,156,157,175,192,191,190,173, //175
    156,157,158,176,193,192,191,174, 157,158,159,177,194,193,192,175, 158,159,160,178,195,194,193,176, 159,160,161,179,196,195,194,177, 160,161,162,180,197,196,195,178, //180
    161,162,163,181,-1,197,196,179, 162,163,-1,-1,-1,-1,197,180, 164,165,166,183,199,198,-1,-1, 165,166,167,184,200,199,198,182, 166,167,168,185,201,200,199,183, //185
    167,168,169,186,202,201,200,184, 168,169,170,187,203,202,201,185, 169,170,171,188,204,203,202,186, 170,171,172,189,205,204,203,187, 171,172,173,190,206,205,204,188,  //190
    172,173,174,191,207,206,205,189, 173,174,175,192,208,207,206,190, 174,175,176,193,209,208,207,191, 175,176,177,194,210,209,208,192, 176,177,178,195,211,210,209,193, //195
    177,178,177,196,212,211,210,194, 178,179,180,197,213,212,211,195, 179,180,181,-1,-1,213,212,196, -1,182,183,199,214,-1,-1,-1, 182,183,184,200,215,214,-1,198,  //200
    183,184,185,201,216,215,214,199, 184,185,186,202,217,216,215,200, 185,186,187,203,218,217,216,201, 186,187,188,204,219,218,217,202, 187,188,189,205,220,219,218,203, //205
    188,189,190,206,221,220,219,204, 189,190,191,207,222,221,220,205, 190,191,192,208,223,222,221,206, 191,192,193,209,224,223,222,207, 192,193,194,210,225,224,223,208, //210
    193,194,195,211,226,225,224,209, 194,195,196,212,227,226,225,210, 195,196,197,213,-1,227,226,211, 196,197,-1,-1,-1,-1,227,212, 198,199,200,215,228,-1,-1,-1, //215
    199,200,201,210,229,228,-1,214, 200,201,202,217,230,229,228,215, 201,202,203,218,231,230,229,210, 202,203,204,219,232,231,230,217, 203,204,205,220,233,232,231,218, //220
    204,205,206,221,234,233,232,219, 205,206,207,222,235,234,233,220, 206,207,208,223,236,235,234,221, 207,208,209,224,237,236,235,222, 208,209,210,225,238,237,236,223,  //225
    209,210,211,226,239,238,237,224, 210,211,212,227,-1,239,238,225, 211,212,213,-1,-1,-1,239,226, 214,215,216,229,240,-1,-1,-1, 215,216,217,230,241,240,-1,228, //230
    216,217,218,231,242,241,240,229, 217,218,219,232,243,242,241,230, 218,219,220,233,244,243,242,231, 219,220,221,234,245,244,243,232, 220,221,222,235,246,245,244,233,  //235
    221,222,223,236,247,246,245,234, 222,223,224,237,248,247,246,235, 223,224,225,238,249,248,247,236, 224,225,226,239,-1,249,248,237, 225,226,227,-1,-1,-1,249,238, //240
    228,229,230,241,-1,-1,-1,-1, 229,230,231,242,250,-1,-1,240, 230,231,232,243,251,250,-1,241, 231,232,233,244,252,251,250,242, 232,233,234,245,253,252,251,243,  //245
    233,234,235,246,254,253,252,244, 234,235,246,247,255,254,253,245, 235,236,237,248,-1,255,254,246, 236,237,238,249,-1,-1,255,247, 237,238,239,-1,-1,-1,-1,248, //250
    241,242,243,251,-1,-1,-1,-1, 242,243,244,252,-1,-1,-1,250, 243,244,245,253,-1,-1,-1,251, 244,245,246,254,-1,-1,-1,252, 245,246,247,255,-1,-1,-1,253, //255
    246,247,248,-1,-1,-1,-1,254
};

Int_t bars_in_rows[256] = {
                    0,0,0,0,0,0,
                1,1,1,1,1,1,1,1,1,1,
              2,2,2,2,2,2,2,2,2,2,2,2,
            3,3,3,3,3,3,3,3,3,3,3,3,3,3,
          4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
          5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
        6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
        7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
        8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,
        9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,
   12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,
   13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,
      14,14,14,14,14,14,14,14,14,14,14,14,14,14,
         15,15,15,15,15,15,15,15,15,15,15,15,
            16,16,16,16,16,16,16,16,16,16,
                  17,17,17,17,17,17
};
